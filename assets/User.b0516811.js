var U=Object.defineProperty;var _=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var h=(o,a,e)=>a in o?U(o,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[a]=e,B=(o,a)=>{for(var e in a||(a={}))I.call(a,e)&&h(o,e,a[e]);if(_)for(var e of _(a))q.call(a,e)&&h(o,e,a[e]);return o};import{M as z}from"./MTable.76dd600a.js";import{b as T,d as M,e as $,f as P,u as N,h as V}from"./index.c7d67714.js";import{_ as Z,a as J,r as C,l as k,m as O,o as j,i as G,h as H,f as K,g as i,w as Q,J as W,E as p,k as X,t as Y}from"./index.349d9e8e.js";import"./MIcon.6c4988d5.js";const ee={class:"menuManager page-container"},ae={class:"tableContainer"},te=J({setup(o){let a=C(!1);const e=k({pageInfo:{},columns:[{prop:"mobile",key:"mobile",label:"\u624B\u673A\u53F7"},{prop:"roleId",key:"roleId",label:"\u89D2\u8272",isCustom:!0}],userList:[],dialogConfig:[{type:"text",label:"\u624B\u673A\u53F7",key:"mobile"},{type:"password",label:"\u5BC6\u7801",key:"password"},{type:"select",label:"\u89D2\u8272",key:"roleId",child:[]}],dialogData:{}}),w=k({mobile:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"},{validator:(s,u,t)=>{/^1[3-9] [0-9]{9}$/.test(u)?t():t(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"))},trigger:"change"}],password:[{required:!0,message:"\u5BC6\u7801\u81F3\u5C11\u5305\u542B\u6570\u5B57\u548C\u82F1\u6587,\u957F\u5EA6\u6700\u5C11\u4E3A8\u4F4D",trigger:"blur"},{validator:(s,u,t)=>{/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,20}$/.test(u)?t():t(new Error("\u8BF7\u8F93\u5165\u6B63\u786E\u683C\u5F0F\u7684\u5BC6\u7801"))},trigger:"change"}]}),d=C(6),g=C(1),c=async(s,u)=>{let t=await T(s,u),l=await M();console.log(t),t.data.code===200&&(e.userList=t.data.data,e.pageInfo.totalCount=l.data.data.num)};c(g.value,d.value);let f=C([]);(async()=>{let s=await $(1,200);console.log(s),f.value=s.data.data.role})();const D=async({rowIndex:s,tableData:u,opera:t,rowInfo:l})=>{var v,b,F;switch(t){case"add":await y(),(v=e.dialogConfig)==null||v.forEach((n,m)=>{n.key==="roleId"&&(e.dialogConfig[m].child=f.value.map(r=>({label:r.name,value:r.id})))}),e.dialogData={},a.value=!0;break;case"edit":(b=e.dialogConfig)==null||b.forEach((n,m)=>{n.key==="roleId"&&(e.dialogConfig[m].child=f.value.map(r=>({label:r.name,value:r.id})))}),e.dialogData=B({},l),a.value=!0;break;case"show":(F=e.dialogConfig)==null||F.forEach((n,m)=>{n.key==="roleId"&&(e.dialogConfig[m].child=f.value.map(r=>({label:r.name,value:r.id})))}),e.dialogData=B({},l),a.value=!0;break;case"delete":W.confirm(`\u4F60\u786E\u5B9A\u8981\u5220\u9664${u[s].mobile}\u7528\u6237\u5417?`,"\u8B66\u544A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",center:!0}).then(async()=>{(await P(l.id)).data.code===200?(p({type:"success",message:"\u5220\u9664\u6210\u529F"}),c(g.value,d.value)):p({type:"error",message:"\u5220\u9664\u5931\u8D25"})}).catch(n=>{});break}};console.log(111);const E=async(s,u)=>{if(console.log(u),u.valid==!0){switch(s.operation){case"add":(await V(s.data)).data.code===200?(p({type:"success",message:"\u65B0\u589E\u6210\u529F"}),a.value=!1,c(g.value,d.value)):p({type:"error",message:"\u6DFB\u52A0\u5931\u8D25"});break;case"edit":let l=await N(s.data);console.log(l),l.data.code===200?(p({type:"success",message:"\u66F4\u65B0\u6210\u529F"}),a.value=!1,c(g.value,d.value)):p({type:"error",message:"\u66F4\u65B0\u5931\u8D25"});break}a.value=!1}},y=async s=>{},{pageInfo:A,columns:x,userList:L,dialogConfig:R,dialogData:S}=O(e);return(s,u)=>(j(),G("div",ee,[H("div",ae,[K(z,{columns:i(x),"table-data":i(L),pagination:{total:i(A).totalCount},rules:i(w),pageSize:d.value,"onUpdate:pageSize":u[0]||(u[0]=t=>d.value=t),currentPage:g.value,"onUpdate:currentPage":u[1]||(u[1]=t=>g.value=t),dialogConfig:i(R),"dialog-status":i(a),"dialog-data":i(S),tableTitle:"\u7528\u6237",onTbDialogSureClick:E,onOperaButtonClick:D,onSelectChange:y,onCurrentPageChange:c,onPageSizeChange:c},{roleId:Q(t=>{var l;return[X(Y((l=i(f).find(v=>v.id==t.row.roleId))==null?void 0:l.name),1)]}),_:1},8,["columns","table-data","pagination","rules","pageSize","currentPage","dialogConfig","dialog-status","dialog-data"])])]))}});var ne=Z(te,[["__scopeId","data-v-2384fd23"]]);export{ne as default};
